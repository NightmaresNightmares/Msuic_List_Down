# 网易云音乐歌单歌曲直链提取器

一个用于自动提取网易云音乐歌单中所有歌曲直链的Python工具。

## 功能特性

- 🎵 自动提取歌单中的所有歌曲直链
- 🎚️ 支持多种音质选择（标准、较高、极高、无损、Hi-Res等）
- 🔄 实时保存，每获取一首歌曲就保存到文件
- 🚀 支持并发下载，提高下载速度
- 🛡️ 自动处理403错误，添加必要的请求头
- 📁 自动创建下载目录，支持断点续传

## 文件说明

- `music_downloader.py` - 主程序，用于提取歌单直链
- `download_songs.py` - 下载器，用于下载歌曲文件
- `download.bat` - Windows批处理文件，方便运行下载器
- `list.txt` - 生成的歌曲列表文件
- `downloads/` - 下载的歌曲文件目录

## 安装依赖

```bash
pip install -r requirements.txt
```

## 使用方法

### 第一步：提取歌单直链

1. 运行主程序：
```bash
python music_downloader.py
```

2. 输入网易云音乐歌单链接或ID，例如：
```
https://music.163.com/playlist?id=947835566
```

3. 选择音质等级（1-9）

4. 程序会自动提取所有歌曲的直链并保存到 `list.txt`

### 第二步：下载歌曲文件

#### 方法一：使用Python脚本
```bash
python download_songs.py
```

#### 方法二：使用批处理文件（Windows）
双击运行 `download.bat`

#### 方法三：手动下载
如果遇到403错误，可以使用支持自定义请求头的下载工具：

**使用curl下载：**
```bash
curl -H "Referer: https://music.163.com/" -H "User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36" -o "歌曲名.mp3" "直链URL"
```

**使用IDM下载：**
1. 添加任务时，在"选项"中添加以下请求头：
   - `Referer: https://music.163.com/`
   - `User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36`

## 音质等级说明

| 等级 | 音质 | 说明 |
|------|------|------|
| 1 | standard | 标准音质 |
| 2 | higher | 较高音质 |
| 3 | exhigh | 极高音质 |
| 4 | lossless | 无损音质 |
| 5 | hires | Hi-Res音质 |
| 6 | jyeffect | 高清环绕声 |
| 7 | sky | 沉浸环绕声 |
| 8 | dolby | 杜比全景声 |
| 9 | jymaster | 超清母带 |

## 注意事项

1. **403错误处理**：网易云音乐的直链需要特定的请求头才能正常访问，程序会自动添加必要的请求头。

2. **下载速度**：建议将并发数设置为1-5，避免被服务器限制。

3. **文件命名**：程序会自动清理文件名中的非法字符，确保文件能正常保存。

4. **断点续传**：如果下载中断，重新运行程序会自动跳过已下载的文件。

5. **API限制**：第三方API可能有访问限制，如果遇到问题请稍后重试。

## 输出文件格式

`list.txt` 文件包含以下信息：
```
# 歌单: 歌单名称
# 音质: standard
# 生成时间: 2025-07-29 03:31:09
==================================================

1. 歌曲名 - 歌手名
   歌曲ID: 123456789
   音质: standard (128012kbps)
   直链: http://...
   大小: 480813 bytes
   类型: mp3
   下载说明: 此直链需要添加Referer请求头才能正常访问
   推荐下载工具: IDM、Aria2、curl等支持自定义请求头的工具
   必要请求头: Referer: https://music.163.com/
   User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36
```

## 常见问题

**Q: 为什么直链打开显示403错误？**
A: 网易云音乐的直链需要特定的请求头才能访问，请使用提供的下载器或添加必要的请求头。

**Q: 下载速度很慢怎么办？**
A: 可以适当增加并发数，但不要设置太高，避免被服务器限制。

**Q: 部分歌曲无法下载？**
A: 可能是版权限制或API限制，请稍后重试或检查歌曲是否可正常播放。

**Q: 文件名乱码怎么办？**
A: 程序会自动处理文件名编码问题，如果仍有问题，请检查系统编码设置。

## 免责声明

本工具仅供学习和研究使用，请遵守相关法律法规和网站使用条款。使用者需要自行承担使用风险，开发者不承担任何法律责任。

## 更新日志

- v2.0: 添加下载器功能，支持并发下载和断点续传
- v1.0: 基础直链提取功能 